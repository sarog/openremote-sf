##
## OpenRemote, the Home of the Digital Home. Copyright 2008-2009, OpenRemote Inc.
## 
## See the contributors.txt file in the distribution for a full listing of individual contributors.
## 
## This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General
## Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any
## later version.
## 
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
## warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more
## details.
## 
## You should have received a copy of the GNU Affero General Public License along with this program. If not, see
## <http://www.gnu.org/licenses/>.
##
##*****************************
##******@author Javen**********
##*****************************
<?xml version="1.0" encoding="UTF-8"?>
<openremote xmlns="http://www.openremote.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openremote.org http://www.openremote.org/schemas/controller.xsd">
  <components>
  	#foreach($screen in $screens)
  		#########################absolute####################
  		#foreach($abs in $screen.getAbsolutes())
  			#set($uiComponent=$abs.getUIComponent())
  			###############UIButton#################
  			#if(${uiComponent.getClass().getName().equals("org.openremote.modeler.domain.component.UIButton")})
  				<button id="${uiComponent.getOid()}">
  				#if(${uiComponent.getUiCommand()})
	  				#set($uiCmd=${uiComponent.getUiCommand()})
	  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
	  					#if($cmd.getDelay().equals(""))
	  						<include type="command" ref="${cmd.getId()}"/>
	  					#else
	  						<delay>${cmd.getDelay()}</delay>
	  					#end
	  				#end
  				#end
  				</button>
  			###############UISwitch#################
  			#elseif(${uiComponent.getClass().getName().equals("org.openremote.modeler.domain.component.UISwitch")})
  				<switch id="${uiComponent.getOid()}">
  					<on>
  						#if(${uiComponent.getOnCommand()})
			  				#set($uiCmd=${uiComponent.getOnCommand()})
			  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
			  					#if($cmd.getDelay().equals(""))
			  						<include type="command" ref="${cmd.getId()}"/>
			  					#else
			  						<delay>${cmd.getDelay()}</delay>
			  					#end
	  						#end
  						#end
  					</on>
  					<off>
  						#if(${uiComponent.getOffCommand()})
				  				#set($uiCmd=${uiComponent.getOffCommand()})
				  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
				  					#if($cmd.getDelay().equals(""))
				  						<include type="command" ref="${cmd.getId()}"/>
				  					#else
				  						<delay>${cmd.getDelay()}</delay>
				  					#end
		  						#end
  						#end
  					</off>
  					<status>
  						#if(${uiComponent.getStatusCommand()})
				  				#set($uiCmd=${uiComponent.getStatusCommand()})
				  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
				  					#if($cmd.getDelay().equals(""))
				  						<include type="command" ref="${cmd.getId()}"/>
				  					#else
				  						<delay>${cmd.getDelay()}</delay>
				  					#end
		  						#end
  						#end
  					</status>
  				</switch>
  			#end
  		#end
  		#########################absolute####################
  		
  		#########################UIGrid####################
  		#foreach($grid in $screen.getGrids())
  			#foreach($cell in $grid.getCells())
  				#set($uiComponent=$cell.getUIComponent())
  				###############UIButton#################
	  			#if(${uiComponent.getClass().getName().equals("org.openremote.modeler.domain.component.UIButton")})
	  				<button id="${uiComponent.getOid()}">
	  				#if(${uiComponent.getUiCommand()})
		  				#set($uiCmd=${uiComponent.getUiCommand()})
		  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
		  					#if($cmd.getDelay().equals(""))
		  						<include type="command" ref="${cmd.getId()}"/>
		  					#else
		  						<delay>${cmd.getDelay()}</delay>
		  					#end
		  				#end
	  				#end
	  				</button>
	  			###############UISwitch#################
	  			#elseif(${uiComponent.getClass().getName().equals("org.openremote.modeler.domain.component.UISwitch")})
	  				<switch id="${uiComponent.getOid()}">
	  					<on>
	  						#if(${uiComponent.getOnCommand()})
				  				#set($uiCmd=${uiComponent.getOnCommand()})
				  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
				  					#if($cmd.getDelay().equals(""))
				  						<include type="command" ref="${cmd.getId()}"/>
				  					#else
				  						<delay>${cmd.getDelay()}</delay>
				  					#end
		  						#end
	  						#end
	  					</on>
	  					<off>
	  						#if(${uiComponent.getOffCommand()})
					  				#set($uiCmd=${uiComponent.getOffCommand()})
					  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
					  					#if($cmd.getDelay().equals(""))
					  						<include type="command" ref="${cmd.getId()}"/>
					  					#else
					  						<delay>${cmd.getDelay()}</delay>
					  					#end
			  						#end
	  						#end
	  					</off>
	  					<status>
	  						#if(${uiComponent.getStatusCommand()})
		  						
					  				#set($uiCmd=${uiComponent.getStatusCommand()})
					  				#foreach($cmd in ${xmlParser.getEventsOfDeviceMacroItem($uiCmd,$eventContainer)})
					  					#if($cmd.getDelay().equals(""))
					  						<include type="command" ref="${cmd.getId()}"/>
					  					#else
					  						<delay>${cmd.getDelay()}</delay>
					  					#end
			  						#end
	  						#end
	  					</status>
	  				</switch>
	  			#end
  			#end
  		#end
  		#########################UIGrid####################
  	#end
  </components>
  <commands>
    #foreach($protocolDisplayName in $eventContainer.getProtocolEvents().keySet())
    	#set($protocalTagName=${protocolContainer.findTagName($protocolDisplayName)})
    	#foreach($uiButtonEvent in $eventContainer.getProtocolEvents().get($protocolDisplayName))
    		<command id="${uiButtonEvent.getId()}" protocol="${protocalTagName}" value="$!{uiButtonEvent.getProtocolAttrs().get("command")}">
    		#set($protocoAttrKeySet=${uiButtonEvent.getProtocolAttrs().keySet()})
    		#foreach($property in $protocoAttrKeySet)
    			#if(${property.equals("command").toString()}=="false")
    				<property name="${property}" value="${uiButtonEvent.getProtocolAttrs().get(${property})}" />
    			#end
    		#end
    		</command>
    	#end
    #end
  </commands>
</openremote>

